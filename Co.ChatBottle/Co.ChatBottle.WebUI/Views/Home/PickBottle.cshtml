@{
    ViewBag.Title = "流浪瓶";
}

<style>
    .fulldiv {
        width: 100%;
        height: 100%;
    }
</style>
@*没捡到瓶子*@
<div id="pick_noBottle" class="fulldiv" style="display:none;"><img src="~/Content/img/emptybottle.jpg" class="fulldiv" id="throwBottle"/></div>
@*捡到一个瓶子*@
<div id="pick_bottle" class="fulldiv" style="display:none"><img src="~/Content/img/findbottle.jpg" class="fulldiv" id="openBottle" data-bottleid=""/></div>
@*捡瓶子时的动画*@
<div id="pickbottlegif" class="fulldiv" style="display:none"><img src="~/Content/img/pickbottle.gif" class="fulldiv" /></div>

<script type="text/javascript">
    $("#throwBottle").click(function () {
        loadPage(pageName.ThrowBottle);
    });

    $("#openBottle").click(function () {
        var param = "?bottleId=" + this.dataset.bottleid;
        loadPage(pageName.BottleDetail, param);
    });

    $("#pick_bottle").hide();
    $("#pick_noBottle").hide();
    $("#pickbottlegif").show();
    $.ajax({
        url: serviceurl + "/api/Bottle/PickBottles",
        type: "get",
        data: { userId: userid },
        success: function (result) {
            setTimeout(function () {
                $("#pickbottlegif").hide();
                if (result.ErrorCode == 0 && result.Result != undefined) {
                    $("#openBottle")[0].dataset.bottleid = result.Result.ID;
                    $("#pick_bottle").show();
                } else {
                    $("#pick_noBottle").show();
                }
            }, 1000);
        },
        error: function (result) {
            $("#pickbottlegif").hide();
            $("#pick_noBottle").show();
        }
    });
</script>