@{
    ViewBag.Title = "流浪瓶";
}
<br />
<div id="noBottle" style="display:none">暂时还没有瓶子哦，去<a id="pickBottle">捡一个</a>试试？</div>
<div id="bottleList" style="display:none"></div>

<script type="text/javascript">
    $("#pickBottle").click(function () {
        loadPage(pageName.PickBottle);
    });

    var bindClick = function () {
        $(".openBottle").click(function () {
            var param = "?bottleId=" + this.dataset.bottleid;
            loadPage(pageName.BottleDetail, param);
        });
    }

    var myBottleInit = function () {
        $("#bottleList").hide();
        $("#noBottle").hide();
        $.ajax({
            url: serviceurl + "/api/Bottle/QueryByUserId",
            type: "get",
            data: { userId: userid },
            success: function (result) {
                if (result.Result != undefined && result.Result.length > 0) {
                    var html = "<ol>";
                    var bottleData = result.Result;
                    $.each(bottleData, function (i, item) {
                        html += '<li><a class="openBottle" data-bottleid=' + item.ID + ' ><span>' + item.BottleDesc + '</span><span>上海闵行</span>-<span>男</span> &nbsp;&nbsp; 未读</a></li>';
                    });
                    html += "</ol>";
                    $("#bottleList").append(html);
                    $("#bottleList").show();
                    bindClick();
                } else {
                    $("#noBottle").show();
                }
            },
            error: function (result) {
                $("#noBottle").show();
            }
        });
    }

    debugger;
    myBottleInit();

</script>